


module.exports = function analyze (args) {

    var state = { value: 0, lastValue: 0, lastPeak: 0, lastBase: 0, direction: 0, fromPeak: 0, fromBase: 0, lastShift: 0 };
    var value, direction, stack = [];

    for(var i = 0; i < data.length; i++){
        value = data[i]
        direction = (value > state.lastValue) ? 1 : (value === state.lastValue ? 0 : -1);
        var s = {
            direction: direction,
            lastValue: state.value,
            value,
            lastPeak: state.lastPeak,
            lastBase: state.lastBase,
            lastShift: state.lastShift,
            fromPeak: state.fromPeak,
            fromBase: state.fromBase,
        }
        if(state.direction === -1 && direction === 1){
            s.lastBase = state.value;
            s.lastShift = 1;
        }
        else if(state.direction === 1 && direction === -1){
            s.lastPeak = state.value;
            s.lastShift = -1;
        }
        if(s.lastPeak){
            s.fromPeak = s.value - s.lastPeak;
        }
        if(s.lastBase){
            s.fromBase = s.value - s.lastBase;
        }
        stack.push(s);
        state = s;
    }

    console.log(stack.slice(0, 6))
    
    process.exit();

};

var data = [
    3.1830296917,
    3.1494161811,
    3.225400682,
    3.2276935676,
    3.1640839753,
    3.156514811,
    3.1669747582,
    3.2544095095,
    3.2225491254,
    3.1719603272,
    3.3610828478,
    3.2320696975,
    3.1911688431,
    3.2681501174,
    3.2020741354,
    3.1427679604,
    3.1413542497,
    3.1423892678,
    3.2012376089,
    3.1997333004,
    3.1890129572,
    3.1864493321,
    3.2128556461,
    3.1200669475,
    3.1720872145,
    3.176803015,
    3.1474691367,
    3.1346431469,
    3.088137823,
    3.0872824009,
    3.1438677846,
    3.164809599,
    3.2148640806,
    3.1083105763,
    3.1499794332,
    3.1170482099,
    3.1446335368,
    3.1746586654,
    3.1950193228,
    3.1542528746,
    3.1639693497,
    3.1699420488,
    3.2053139317,
    3.2864709417,
    3.230927519,
    3.2384980471,
    3.3051187058,
    3.3235690092,
    3.2980143815,
    3.2674179974,
    3.2701745529,
    3.2689414527,
    3.2652524276,
    3.2635407083,
    3.3219765116,
    3.3458601674,
    3.3680773747,
    3.2150251968,
    3.0120058171,
    3.0594151715,
    2.962106057,
    2.9488298907,
    2.9324004655,
    2.9334426984,
    3.0250506041,
    3.0216392646,
    2.9318847232,
    2.9574753509,
    3.051383888,
    3.0141296139,
    3.0456283995,
    3.0020741835,
    2.9076612863,
    2.9049532297,
    2.9926426496,
    3.0288821666,
    3.0085806976,
    2.9177472198,
    2.859831948,
    3.0019359456,
    2.9118124999,
    2.8893039442,
    3.0240391443,
    2.9108772895,
    2.8803505616,
    2.9667795511,
    2.9596019258,
    2.9605511773,
    2.8732060696,
    2.8724812017,
    2.9678858487,
    2.9704981494,
    2.9713909748,
    2.9723463211,
    2.9721310666,
    2.9698821274,
    2.965421552,
    2.9610656144,
    2.9602046555,
    2.9597029381,
    2.9582739653,
    2.8792277544,
    2.8818833388,
    2.9624563591,
    2.9587127245,
    2.955492049,
    2.8790439665,
    2.8815509212,
    2.9810678793,
    2.9020736155,
    2.8471977789,
    2.929564111,
    2.9751482828,
    2.9630981811,
    2.9333071826,
    2.9208086152,
    2.9352757841,
    2.9230405496,
    2.9193987502,
    2.8971057955,
    2.9265100093,
    2.9277994329,
    2.9178895347,
    2.9164710131,
    2.8862746751,
    2.7907826023,
    2.789021265,
    2.8813918267,
    2.8816862273,
    2.9006905105,
    2.883792281,
    2.9436263743,
    2.8734950768,
    2.816970554,
    2.9148238871,
    2.9407191099,
    2.9156356429,
    2.878910551,
    2.9617395243,
    2.8953801166,
    2.8884544736,
    2.8743673847,
    2.8401594525,
    2.8207366577,
    2.8870902328,
    2.8896386913,
    2.9288237466,
    3.0371339644,
    2.9095869581,
    2.8363313797,
    2.8901140811,
    2.9292996071,
    2.9179853912,
    2.8918507625,
    2.9094419032,
    2.8292012673,
    2.8762756651,
    2.87077157,
    2.7900491773,
    2.7891035031,
    2.8552650234,
    2.8449552521,
    2.7990115557,
    2.8175694742,
    2.9275589999,
    2.8178067613,
    2.8524720417,
    2.8504055882,
    2.799242034,
    2.7926209106,
    2.8580630483,
    2.790662438,
    2.8238930434,
    2.8906757917,
    2.8132771058,
    2.7940272732,
    2.8974807293,
    2.8842802912,
    2.9230107002,
    2.9379201298,
    2.9147096185,
    2.906307543,
    2.990684642,
    3.0234902662,
    3.0472246187,
    2.9884799027,
    2.9913531717,
    3.0283122498,
    2.9648490308,
    2.9476223882,
    3.0366073602,
    2.983459148,
    3.0007513258,
    3.0704726911,
    3.0565532803,
    2.9865691664,
    2.9977556795,
    3.016419816,
    3.0015528023,
    2.9681936716,
    2.9846094508,
    2.9186348172,
    3.0095256553,
    3.0185335816,
    3.0195247935,
    3.0451967933,
    2.9763208127,
    2.9874303819,
    3.1376224373,
    3.0268435592,
    3.0425600636,
    3.0957512931,
    3.0386651608,
    3.0362172672,
    3.1693523267,
    3.1360371099,
    3.1986132343,
    3.0902449218,
    3.09872623,
    3.1344315287,
    3.1933227683,
    3.1766183573,
    3.2027128379,
    3.0693686921,
    3.0707484278,
    3.1027006543,
    3.1216266592,
    3.1004540394,
    3.1897918587,
    3.1357893092,
    3.1948306537,
    3.1446686484,
    3.1339880282,
    3.0830254435,
    3.1830275499,
    3.1151898706,
    3.1191394149,
    3.2370310854,
    3.2532825014,
    3.1703374136,
    3.1705055014,
    3.2733701339,
    3.2510645734,
    3.2861916478,
    3.2645145402,
    3.2588612336,
    3.2557109543,
    3.2548317016,
    3.19324814,
    3.1964609726,
    3.2323592186,
    3.1575320958,
    2.9671384718,
    3.0234390303,
    3.0775868787,
    3.0519656344,
    2.9799631295,
    2.9761452821,
    3.0286483744,
    2.9644737902,
    2.9619813547,
    3.0342371595,
    3.0387738786,
    2.9891275275,
    3.0463886723,
    2.9829085422,
    2.9731598016,
    3.0213790318,
    3.0231789826,
    3.0376072323,
    2.9867511407,
    2.9340082388,
    2.9835181055,
    2.9799402406,
    2.9399153166,
    2.9574848997,
    2.9284002673,
    2.9344171218,
    2.9920162504,
    2.9876021371,
    2.981991023,
    2.9817391278,
    2.933810395,
    2.9369222435,
    2.9918958034,
    2.9519677328,
    2.9666864161,
    3.0201176934
  ]